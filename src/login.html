<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>Artlink - NFT Marketplace</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content=" " />
    <meta name="keywords" content="" />
    <meta content="Pichforest" name="author" />

    <link rel="shortcut icon" href="images/favicon.ico">

    <!-- Bootstrap css -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" id="bootstrap-style" />

    <!-- Material Icon Css -->
    <link rel="stylesheet" href="css/materialdesignicons.min.css" type="text/css" />

    <!-- Unicon Css -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css" />

    <!-- Custom Css -->
    <link rel="stylesheet" href="css/style.min.css" type="text/css" />

    <!-- Additional CSS-->
    <link rel="stylesheet" href="css/snackbar.style.css"/>

</head>

<body>

    <!-- light-dark mode button -->
    <a href="javascript: void(0);" id="mode" class="mode-btn text-white rounded-end">
        <i class="uil uil-brightness mode-dark mx-auto"></i>
        <i class="uil uil-moon bx-spin mode-light"></i>
    </a>

    
    <div id="snackbar" class="snackbar">
        <span class="close" onclick="hideSnackBar()">&times;</span>
        <p id="snackbarmessage"></p>
    </div>    
    <!-- start section -->
    <section class="login section position-relative overflow-hidden"
        style="background-image: url(./images/inner-image/login.png); background-repeat: no-repeat;">
        <!-- start container -->
        <!-- <div class="bg-overlay"></div> -->
        <div class="container position-relative">
            <div class="row justify-content-center">
                <div class="col-lg-6">
                    <form class="mt-2 inner-heading" action="/login" method="post" id="login-form">                           
                        <h1 class="fw-bold">Welcome üñê To Artlink</h1>

                        <p class="text-muted">Don't have an account yet? <a href="/register"
                                class="text-blue">Register</a> </p>

                        <div class="info-box">
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="email  mt-4">
                                        <label for="validationDefault03" class="form-label fw-semibold"> Email Address
                                            :</label>
                                        <input type="email" name="email" class="form-control" id="email"
                                            placeholder="Enter Your Email" required>
                                    </div>
                                </div>

                                <div class="col-lg-12">
                                    <div class="password  mt-4">
                                        <label for="validationDefault01" class="form-label fw-semibold">Password
                                            :</label>
                                        <input type="password" name="password" class="form-control" id="password"
                                         value="" required>
                                    </div>
                                </div>

                                <!--TODO: Implement reset password functionality -->
                                <div class="col-lg-12">
                                    <div class="d-flex align-items-center mt-4">
                                        <a href="/reset-password"><p>Forgot password?</p></a>
                                    </div>
                                </div>


                                <div class="col-12 ">
                                    <div class="d-flex align-items-center mt-4">
                                        <div class="verify">
                                            <button type="button" class="btn border btn-light text-dark shadow-sm"
                                                id="liveToastBtn">Click to verify</button>
                                        </div>
                                        <div class="other ms-auto">
                                            <div class="mb-0 text-muted fw-semibold">Login With : <a href=""
                                                    class="text-dark ms-2">Google</a> <a href=""
                                                    class="text-dark ms-4">Facebook</a></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="submit-button mt-4">
                                <button class="btn btn-primary w-100" type="submit">Submit</button>
                            </div>
                        </div>

                        <div class="position-fixed start-0 bottom-50 p-3" style="z-index: 999">
                            <div id="liveToast" class="toast position-relative" role="alert" aria-live="assertive"
                                aria-atomic="true">
                                <div class="toast-header">

                                    <div class="d-flex align-items-center">
                                        <div class="flex-shrink-0">
                                            <i class="mdi mdi-check-circle text-success f-30"></i>
                                        </div>
                                        <div class="flex-grow-1 ms-2">
                                            <strong>Login Unsuccessful</strong>

                                        </div>
                                    </div>
                                </div>
                                <div class="toast-body">
                                    Incorrect password/email. Please try again
                                </div>
                                <div class="progress" style="height: 5px;">
                                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                                        role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"
                                        style="width: 95%;"></div>
                                </div>
                            </div>
                        </div>  
                    </form>
                </div>
            </div>


        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js"></script>
        <script>
            const form = document.querySelector('#login-form');
            const snackbar = document.querySelector('#snackbar');

            function showSnackBar(message) {
                const snackBarMessage = document.querySelector('#snackbarmessage');

                snackBarMessage.innerHTML = message;
                snackbar.classList.add('show');

                setTimeout(function(){ snackbar.className = snackbar.className.replace('show', '');}, 3000);
            }

            function hideSnackBar() {
                snackbar.classList.remove('show');
            }

            form.addEventListener('submit', (event) => {
                event.preventDefault();

            const email = form.querySelector('#email').value;
            const password = form.querySelector('#password').value;
            
            try {

                // axios.post('/login', {
                //     email: email,
                //     password: password
                // })
                // .then(function (response) {
                //     if (response) {
                //         window.location.href('/marketplace');
                //     } else {
                //         response.json().then(function(data) {
                //             var errorMsg = data.Error;
                //             showSnackBar(errorMsg);
                //         })
                //     }
                // })
                // .catch(function(error) {
                //     console.error(`Error authenticating user ${error}`)
                // });
                fetch('/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({email, password})
                })
                .then(function(response) {
                    if (response.ok) {
                        window.location.href = '/marketplace';
                    } else {
                        response.json().then(function(data) {
                            var errorMessage = data.error;
                            showSnackBar(errorMessage);
                        });
                    }
                })
                .catch(function(error) {
                    console.error(`Error authenticating user: ${error}`);
                })
                } catch (error) {
                console.log(`Error: ${error}`);
                }
                });

        </script>
        <!-- end container -->
    </section>


    <!--Bootstrap Js-->
    <script src="js/bootstrap.bundle.min.js"></script>

    <script src="js/bootstrap-toasts.init.js"></script>

    <!-- App Js -->
    <script src="js/app.js"></script>

   
</body>

</html>